rule install_telocate:
    params:
        url = config['URLs']['te-locate'],
        md5 = config['MD5s']['te-locate'],
        tar = config['paths']['install']+"tools/te-locate/te-locate.tar",
        log = config['paths']['log_dir']+"install.log"

    output:
        config['paths']['install']+"tools/te-locate/TE_locate.pl",
        config['paths']['install']+"tools/te-locate/TE_hierarchy.pl"
    
    conda: config['paths']['envs']+"mcc_telocate.yml"

    script:
        config['paths']['install']+"te-locate.py"


rule install_retroseq:
    params:
        url = config['URLs']['retroseq'],
        md5 = config['MD5s']['retroseq'],
        zipfile = config['paths']['install']+"tools/retroseq/retroseq.zip",
        log = config['paths']['log_dir']+"install.log"

    output:
        config['paths']['install']+"tools/retroseq/bin/retroseq.pl"
    
    conda: config['paths']['envs']+"mcc_retroseq.yml"

    script:
        config['paths']['install']+"retroseq.py"

rule install_temp:
    params:
        url = config['URLs']['temp'],
        md5 = config['MD5s']['temp'],
        zipfile = config['paths']['install']+"tools/temp/temp.zip",
        log = config['paths']['log_dir']+"install.log",
        patch = config['paths']['install']+"patches/temp/TEMP_Absence.patch"

    output:
        config['paths']['install']+"tools/temp/scripts/TEMP_Insertion.sh",
        config['paths']['install']+"tools/temp/scripts/TEMP_Absence.sh"
    
    conda: config['paths']['envs']+"mcc_temp.yml"

    script:
        config['paths']['install']+"temp.py"

rule install_relocaTE:
    params:
        url = config['URLs']['relocate'],
        md5 = config['MD5s']['relocate'],
        zipfile = config['paths']['install']+"tools/relocate/relocate.zip",
        log = config['paths']['log_dir']+"install.log",
        patch = config['paths']['install']+"patches/relocate/relocaTE_insertionFinder.patch"
    
    output:
        config['paths']['install']+"tools/relocate/scripts/relocaTE_insertionFinder.pl"

    conda: config['paths']['envs']+"mcc_relocate.yml"

    script:
       config['paths']['install']+"relocate.py" 

rule install_relocaTE2:
    params:
        url = config['URLs']['relocate2'],
        md5 = config['MD5s']['relocate2'],
        zipfile = config['paths']['install']+"tools/relocate2/relocate2.zip",
        log = config['paths']['log_dir']+"install.log"

    conda: config['paths']['envs']+"mcc_relocate2.yml"

    output:
        config['paths']['install']+"tools/relocate2/scripts/relocaTE2.py"
    
    script:
        config['paths']['install']+"relocate2.py"

rule install_ngs_te_mapper:
    params:
        url = config['URLs']['ngs_te_mapper'],
        md5 = config['MD5s']['ngs_te_mapper'],
        zipfile = config['paths']['install']+"tools/ngs_te_mapper/ngs_te_mapper.zip",
        log = config['paths']['log_dir']+"install.log"
    
    output:
        config['paths']['install']+"tools/ngs_te_mapper/sourceCode/run_ngs_te_mapper.sh"
    
    conda: config['paths']['envs']+"mcc_ngs_te_mapper.yml"

    script:
        config['paths']['install']+"ngs_te_mapper.py"
    
rule install_popoolationTE:
    params:
        url = config['URLs']['popoolationte'],
        md5 = config['MD5s']['popoolationte'],
        zipfile = config['paths']['install']+"tools/popoolationte.zip",
        log = config['paths']['log_dir']+"install.log",
        patch1 = config['paths']['install']+"patches/popoolationte/TEInsertUtility.patch",
        patch2 = config['paths']['install']+"patches/popoolationte/TEInsert.patch",
        patch3 = config['paths']['install']+"patches/popoolationte/samro.patch",
        patch4 = config['paths']['install']+"patches/popoolationte/identify-te-insertsites.patch"
    
    output:
        config['paths']['install']+"tools/popoolationte/Modules/TEInsertUtility.pm",
        config['paths']['install']+"tools/popoolationte/Modules/TEInsert.pm",
        config['paths']['install']+"tools/popoolationte/samro.pl",
        config['paths']['install']+"tools/popoolationte/identify-te-insertsites.pl"
    
    conda: config['paths']['envs']+"mcc_popoolationte.yml"

    script:
        config['paths']['install']+"popoolationte.py"

rule install_coverage:
    params:
        zipfile = config['paths']['install']+"tools/coverage.zip",
        log = config['paths']['log_dir']+"install.log"

    output:
        config['paths']['install']+"tools/coverage/coverage.log"    

    conda: config['paths']['envs']+"mcc_coverage.yml"

    shell:
        "echo 'coverage env installed' > {output}"

rule install_all:
    input:
        config['paths']['install']+"tools/te-locate/TE_locate.pl",
        config['paths']['install']+"tools/te-locate/TE_hierarchy.pl",
        config['paths']['install']+"tools/retroseq/bin/retroseq.pl",
        config['paths']['install']+"tools/temp/scripts/TEMP_Insertion.sh",
        config['paths']['install']+"tools/temp/scripts/TEMP_Absence.sh",
        config['paths']['install']+"tools/relocate/scripts/relocaTE_insertionFinder.pl",
        config['paths']['install']+"tools/ngs_te_mapper/sourceCode/run_ngs_te_mapper.sh",
        config['paths']['install']+"tools/popoolationte/Modules/TEInsertUtility.pm",
        config['paths']['install']+"tools/popoolationte/Modules/TEInsert.pm",
        config['paths']['install']+"tools/popoolationte/samro.pl",
        config['paths']['install']+"tools/popoolationte/identify-te-insertsites.pl",
        config['paths']['install']+"tools/coverage/coverage.log",
        config['paths']['install']+"tools/relocate2/scripts/relocaTE2.py"
    
    conda: config['paths']['envs']+"mcc_processing.yml"

    shell:
        "echo 'install done!'"
